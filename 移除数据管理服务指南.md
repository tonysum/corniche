# ç§»é™¤æ•°æ®ç®¡ç†æœåŠ¡æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

ç”±äºæ•°æ®ç®¡ç†æ¨¡å—å·²ç»ç‹¬ç«‹ä¸ºå•ç‹¬çš„é¡¹ç›® (`crypto-data-manager`)ï¼Œç°åœ¨éœ€è¦ä»åŸé¡¹ç›® (`corniche`) ä¸­ç§»é™¤æ•°æ®ç®¡ç†æœåŠ¡ç›¸å…³çš„éƒ¨åˆ†ã€‚

## âš ï¸ é‡è¦è¯´æ˜

**ä»¥ä¸‹æ–‡ä»¶å°†è¢«ä¿ç•™**ï¼ˆå› ä¸ºå›æµ‹æœåŠ¡éœ€è¦ä½¿ç”¨ï¼‰ï¼š
- `backend/db.py` - æ•°æ®åº“è¿æ¥æ¨¡å—ï¼ˆå›æµ‹æœåŠ¡ä½¿ç”¨ï¼‰
- `backend/data.py` - æ•°æ®æŸ¥è¯¢æ¨¡å—ï¼ˆå›æµ‹æœåŠ¡ä½¿ç”¨ï¼‰
- `backend/binance_api.py` - å¸å®‰APIæ¨¡å—ï¼ˆå¯èƒ½è¢«å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼‰

## ğŸ—‘ï¸ å°†è¢«ç§»é™¤çš„å†…å®¹

### 1. ç›®å½•å’Œæ–‡ä»¶

- âœ… `backend/services/data_service/` - æ•°æ®ç®¡ç†æœåŠ¡ç›®å½•
- âœ… `frontend-data/` - æ•°æ®ç®¡ç†å‰ç«¯ç›®å½•
- âš ï¸ `backend/download_klines.py` - æ•°æ®ä¸‹è½½è„šæœ¬ï¼ˆå¯é€‰ï¼Œè„šæœ¬ä¼šè¯¢é—®ï¼‰
- âš ï¸ `backend/migrate.py` - æ•°æ®åº“è¿ç§»å·¥å…·ï¼ˆå¯é€‰ï¼Œè„šæœ¬ä¼šè¯¢é—®ï¼‰

### 2. é…ç½®æ–‡ä»¶æ›´æ–°

- âœ… `backend/services/shared/config.py` - ç§»é™¤ `DATA_SERVICE_PORT` å’Œç›¸å…³çš„ CORS é…ç½®
- âœ… `backend/start-services.sh` - ç§»é™¤æ•°æ®æœåŠ¡å¯åŠ¨ä»£ç 
- âœ… `docker-compose.yml` - ç§»é™¤ `data-service` å’Œ `frontend-data` æœåŠ¡
- âœ… `backend/README.md` - ç§»é™¤æ•°æ®ç®¡ç†æœåŠ¡ç›¸å…³è¯´æ˜

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨Pythonè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/tony/Documents/crypto/corniche
python scripts/remove_data_service.py
```

### æ–¹æ³•2: ä½¿ç”¨Shellè„šæœ¬

```bash
cd /Users/tony/Documents/crypto/corniche
./scripts/remove_data_service.sh
```

### æ–¹æ³•3: æ‰‹åŠ¨ç§»é™¤

æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤æ‰‹åŠ¨ç§»é™¤ï¼š

#### æ­¥éª¤1: åˆ é™¤ç›®å½•

```bash
# åˆ é™¤æ•°æ®ç®¡ç†æœåŠ¡
rm -rf backend/services/data_service

# åˆ é™¤æ•°æ®ç®¡ç†å‰ç«¯
rm -rf frontend-data
```

#### æ­¥éª¤2: æ›´æ–°é…ç½®æ–‡ä»¶

**`backend/services/shared/config.py`**

ç§»é™¤ä»¥ä¸‹å†…å®¹ï¼š
```python
DATA_SERVICE_PORT = int(os.getenv("DATA_SERVICE_PORT", "8001"))
```

ç§»é™¤ CORS é…ç½®ä¸­çš„ï¼š
```python
"http://localhost:3001",  # æ•°æ®ç®¡ç†å‰ç«¯
"http://127.0.0.1:3001",
"http://8.216.33.6:3001",  # æ•°æ®ç®¡ç†å‰ç«¯ï¼ˆæœåŠ¡å™¨ï¼‰
```

**`backend/start-services.sh`**

ç§»é™¤æ•°æ®æœåŠ¡å¯åŠ¨ç›¸å…³çš„ä»£ç å—ã€‚

**`docker-compose.yml`**

ç§»é™¤ä»¥ä¸‹æœåŠ¡å—ï¼š
- `data-service:` æœåŠ¡
- `frontend-data:` æœåŠ¡

#### æ­¥éª¤3: æ›´æ–°æ–‡æ¡£

æ›´æ–° `backend/README.md`ï¼Œç§»é™¤æ•°æ®ç®¡ç†æœåŠ¡ç›¸å…³è¯´æ˜ã€‚

## âœ… éªŒè¯æ¸…å•

ç§»é™¤åï¼Œè¯·éªŒè¯ï¼š

- [ ] `backend/services/data_service/` ç›®å½•å·²åˆ é™¤
- [ ] `frontend-data/` ç›®å½•å·²åˆ é™¤
- [ ] `backend/services/shared/config.py` ä¸­å·²ç§»é™¤ `DATA_SERVICE_PORT`
- [ ] `backend/start-services.sh` ä¸­å·²ç§»é™¤æ•°æ®æœåŠ¡å¯åŠ¨ä»£ç 
- [ ] `docker-compose.yml` ä¸­å·²ç§»é™¤æ•°æ®æœåŠ¡ç›¸å…³é…ç½®
- [ ] å›æµ‹æœåŠ¡å¯ä»¥æ­£å¸¸å¯åŠ¨
- [ ] è®¢å•æœåŠ¡å¯ä»¥æ­£å¸¸å¯åŠ¨

## ğŸ” æ£€æŸ¥ä¾èµ–å…³ç³»

åœ¨ç§»é™¤å‰ï¼Œè„šæœ¬ä¼šæ£€æŸ¥ä»¥ä¸‹ä¾èµ–ï¼š

1. **å›æµ‹æœåŠ¡ä¾èµ–**
   - `backend/backtrade.py` ä½¿ç”¨ `db.py` å’Œ `data.py`
   - `backend/backtrade4.py` ä½¿ç”¨ `db.py` å’Œ `data.py`
   - `backend/smartmoney.py` ä½¿ç”¨ `db.py` å’Œ `data.py`
   - `backend/hm*.py` ç³»åˆ—æ–‡ä»¶ä½¿ç”¨ `db.py`

2. **ä¿ç•™çš„æ–‡ä»¶**
   - `backend/db.py` âœ… ä¿ç•™ï¼ˆå›æµ‹æœåŠ¡éœ€è¦ï¼‰
   - `backend/data.py` âœ… ä¿ç•™ï¼ˆå›æµ‹æœåŠ¡éœ€è¦ï¼‰
   - `backend/binance_api.py` âœ… ä¿ç•™ï¼ˆå¯èƒ½è¢«å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼‰

## ğŸ“ åç»­å·¥ä½œ

ç§»é™¤æ•°æ®ç®¡ç†æœåŠ¡åï¼š

1. **æ›´æ–°æ–‡æ¡£**
   - æ›´æ–°é¡¹ç›® README
   - æ›´æ–°å¾®æœåŠ¡æ¶æ„è¯´æ˜
   - æ›´æ–°éƒ¨ç½²æ–‡æ¡£

2. **æ›´æ–°å‰ç«¯**
   - å¦‚æœå‰ç«¯éœ€è¦æ•°æ®ç®¡ç†åŠŸèƒ½ï¼Œåº”è°ƒç”¨ç‹¬ç«‹çš„æ•°æ®ç®¡ç†æœåŠ¡ API
   - æ›´æ–°å‰ç«¯ API é…ç½®

3. **æœåŠ¡é€šä¿¡**
   - å¦‚æœå›æµ‹æœåŠ¡éœ€è¦æ•°æ®ç®¡ç†åŠŸèƒ½ï¼Œåº”é€šè¿‡ HTTP API è°ƒç”¨ç‹¬ç«‹çš„æ•°æ®ç®¡ç†æœåŠ¡
   - æˆ–ä¿ç•™å¿…è¦çš„æ•°æ®åº“è®¿é—®åŠŸèƒ½

## ğŸ”„ å¦‚æœéœ€è¦æ¢å¤

å¦‚æœè¯¯åˆ äº†æ–‡ä»¶ï¼Œå¯ä»¥ä» Git å†å²æ¢å¤ï¼š

```bash
# æŸ¥çœ‹åˆ é™¤çš„æ–‡ä»¶
git log --all --full-history -- backend/services/data_service/

# æ¢å¤æ–‡ä»¶
git checkout <commit-hash> -- backend/services/data_service/
```

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- [æ•°æ®ç®¡ç†æ¨¡å—ç‹¬ç«‹é¡¹ç›®æ–¹æ¡ˆ.md](./æ•°æ®ç®¡ç†æ¨¡å—ç‹¬ç«‹é¡¹ç›®æ–¹æ¡ˆ.md)
- [æ•°æ®ç®¡ç†æ¨¡å—è¿ç§»æŒ‡å—.md](./æ•°æ®ç®¡ç†æ¨¡å—è¿ç§»æŒ‡å—.md)
